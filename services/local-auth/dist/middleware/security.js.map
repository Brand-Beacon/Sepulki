{"version":3,"file":"security.js","sourceRoot":"","sources":["../../src/middleware/security.ts"],"names":[],"mappings":"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"}