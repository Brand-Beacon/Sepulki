# ==========================================
# HAMMER ORCHESTRATOR - ENVIRONMENT VARIABLES
# ==========================================
# GraphQL API gateway and fleet orchestration service for Sepulki platform
# This service coordinates robots, tasks, and telemetry data

# ==========================================
# NODE ENVIRONMENT
# ==========================================
NODE_ENV=development

# ==========================================
# SERVER CONFIGURATION
# ==========================================
# Port for the GraphQL API server
PORT=4000

# Host binding (use 0.0.0.0 for Docker, localhost for local dev)
HOST=0.0.0.0

# ==========================================
# DATABASE CONFIGURATION (PostgreSQL)
# ==========================================
# PostgreSQL connection string
# Development: postgresql://smith:forge_dev@localhost:5432/sepulki
# Production: Use managed database (AWS RDS, Supabase, etc.)
# Format: postgresql://username:password@host:port/database
DATABASE_URL=postgresql://smith:forge_dev@localhost:5432/sepulki

# Database connection pool settings
DATABASE_POOL_MIN=2
DATABASE_POOL_MAX=20
DATABASE_IDLE_TIMEOUT_MS=30000
DATABASE_CONNECTION_TIMEOUT_MS=5000

# Enable SSL for database connection (required for most cloud databases)
# DATABASE_SSL=true
# DATABASE_SSL_REJECT_UNAUTHORIZED=false

# ==========================================
# REDIS CONFIGURATION
# ==========================================
# Redis connection string for caching and pub/sub
# Development: redis://localhost:6379
# Production: redis://username:password@host:port/db
REDIS_URL=redis://localhost:6379

# Redis connection pool settings
# REDIS_MAX_RETRIES_PER_REQUEST=3
# REDIS_ENABLE_OFFLINE_QUEUE=true

# Redis key prefix (useful for multi-tenant setups)
# REDIS_KEY_PREFIX=sepulki:

# ==========================================
# AUTHENTICATION & JWT
# ==========================================
# JWT secret for token verification (must match local-auth service)
# Generate with: openssl rand -base64 32
# ⚠️  WARNING: This must be the same across all services!
JWT_SECRET=local-auth-jwt-secret

# JWT token expiration (in seconds or time string)
JWT_EXPIRATION=86400

# JWT issuer
JWT_ISSUER=sepulki-platform

# ==========================================
# CORS CONFIGURATION
# ==========================================
# Allowed origins for CORS (comma-separated)
# Development: http://localhost:3000,http://127.0.0.1:3000
# Production: https://your-domain.com,https://www.your-domain.com
CORS_ORIGIN=http://localhost:3000,http://127.0.0.1:3000

# Enable credentials in CORS
CORS_CREDENTIALS=true

# ==========================================
# GRAPHQL CONFIGURATION
# ==========================================
# Enable GraphQL Playground in development
GRAPHQL_PLAYGROUND=true

# Enable GraphQL introspection (disable in production for security)
GRAPHQL_INTROSPECTION=true

# GraphQL query complexity limit
# GRAPHQL_COMPLEXITY_LIMIT=1000

# GraphQL query depth limit
# GRAPHQL_DEPTH_LIMIT=10

# ==========================================
# FILE STORAGE CONFIGURATION
# ==========================================
# File storage type: local, minio, or s3
FILE_STORAGE_TYPE=local

# Local file storage path (for development)
FILE_STORAGE_PATH=./uploads

# MinIO configuration (for local development)
MINIO_ENDPOINT=localhost:9000
MINIO_PORT=9000
MINIO_ACCESS_KEY=sepulki
MINIO_SECRET_KEY=vault_dev_key
MINIO_USE_SSL=false
MINIO_BUCKET=sepulki-files

# AWS S3 configuration (for production)
# AWS_REGION=us-east-1
# AWS_ACCESS_KEY_ID=your-aws-access-key-id
# AWS_SECRET_ACCESS_KEY=your-aws-secret-access-key
# AWS_S3_BUCKET=sepulki-production-files
# AWS_S3_PUBLIC_URL=https://cdn.your-domain.com

# ==========================================
# TELEMETRY CONFIGURATION
# ==========================================
# Enable automatic telemetry data generation (for development/demo)
ENABLE_TELEMETRY=true

# Telemetry generation interval (in milliseconds)
TELEMETRY_INTERVAL_MS=5000

# Telemetry batch size (number of readings per batch)
TELEMETRY_BATCH_SIZE=10

# ==========================================
# INFLUXDB CONFIGURATION (Optional)
# ==========================================
# InfluxDB for time-series telemetry data (optional, for production)
# INFLUXDB_URL=http://localhost:8086
# INFLUXDB_TOKEN=your-influxdb-token
# INFLUXDB_ORG=sepulki
# INFLUXDB_BUCKET=bellows

# ==========================================
# EXTERNAL SERVICES
# ==========================================
# Isaac Sim endpoint (for simulation control)
ISAAC_SIM_ENDPOINT=http://18.234.83.45:8211

# Anvil Sim service endpoint (if separate from Isaac Sim)
# ANVIL_SIM_ENDPOINT=http://localhost:8080

# Video stream proxy endpoint
VIDEO_PROXY_ENDPOINT=http://localhost:8889

# ==========================================
# RATE LIMITING
# ==========================================
# Enable rate limiting
RATE_LIMIT_ENABLED=true

# Rate limit window (in milliseconds)
RATE_LIMIT_WINDOW_MS=60000

# Maximum requests per window
RATE_LIMIT_MAX_REQUESTS=100

# ==========================================
# LOGGING CONFIGURATION
# ==========================================
# Log level: error, warn, info, debug
LOG_LEVEL=info

# Log format: json or pretty
LOG_FORMAT=pretty

# Enable request logging
LOG_REQUESTS=true

# Log file path (optional, logs to console if not set)
# LOG_FILE_PATH=./logs/hammer-orchestrator.log

# ==========================================
# ERROR TRACKING (Sentry)
# ==========================================
# Sentry DSN for error tracking (optional)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/your-project-id

# Sentry environment
# SENTRY_ENVIRONMENT=development

# Sentry traces sample rate (0.0 to 1.0)
# SENTRY_TRACES_SAMPLE_RATE=0.1

# ==========================================
# BACKGROUND JOBS (Bull/BullMQ)
# ==========================================
# Enable background job processing
# ENABLE_BACKGROUND_JOBS=true

# Number of concurrent job workers
# JOB_CONCURRENCY=5

# Job retry attempts
# JOB_MAX_RETRY_ATTEMPTS=3

# ==========================================
# WEBHOOK CONFIGURATION
# ==========================================
# Webhook secret for verifying incoming webhooks
# WEBHOOK_SECRET=your-webhook-secret

# Webhook retry configuration
# WEBHOOK_MAX_RETRY_ATTEMPTS=3
# WEBHOOK_RETRY_DELAY_MS=1000

# ==========================================
# API KEYS FOR EXTERNAL SERVICES
# ==========================================
# OpenAI API key (for AI features)
# OPENAI_API_KEY=your-openai-api-key

# Twilio API keys (for SMS notifications)
# TWILIO_ACCOUNT_SID=your-twilio-account-sid
# TWILIO_AUTH_TOKEN=your-twilio-auth-token
# TWILIO_PHONE_NUMBER=+1234567890

# SendGrid API key (for email notifications)
# SENDGRID_API_KEY=your-sendgrid-api-key
# SENDGRID_FROM_EMAIL=noreply@sepulki.com

# ==========================================
# FEATURE FLAGS
# ==========================================
# Enable experimental features
ENABLE_EXPERIMENTAL_FEATURES=false

# Enable GraphQL subscriptions (WebSocket)
ENABLE_SUBSCRIPTIONS=true

# Enable file uploads
ENABLE_FILE_UPLOADS=true

# Enable telemetry generation
ENABLE_TELEMETRY_GENERATION=true

# ==========================================
# HEALTH CHECK CONFIGURATION
# ==========================================
# Health check endpoint path
HEALTH_CHECK_PATH=/health

# Enable detailed health check (includes database, redis status)
HEALTH_CHECK_DETAILED=true

# ==========================================
# PERFORMANCE MONITORING
# ==========================================
# Enable Apollo Studio metrics (optional)
# APOLLO_KEY=your-apollo-studio-key
# APOLLO_GRAPH_VARIANT=production

# Enable performance tracing
# ENABLE_TRACING=true

# ==========================================
# SECURITY SETTINGS
# ==========================================
# Enable helmet.js security headers
ENABLE_SECURITY_HEADERS=true

# Enable CSRF protection
ENABLE_CSRF_PROTECTION=false

# Trusted proxy IPs (comma-separated, for X-Forwarded-* headers)
# TRUSTED_PROXY_IPS=127.0.0.1,::1

# ==========================================
# DEPLOYMENT PLATFORM VARIABLES
# ==========================================
# These are typically auto-set by deployment platforms

# Railway variables (auto-detected)
# RAILWAY_ENVIRONMENT=production
# RAILWAY_STATIC_URL=auto-detected

# Render variables (auto-detected)
# RENDER_EXTERNAL_URL=auto-detected

# Heroku variables (auto-detected)
# HEROKU_APP_NAME=auto-detected

# ==========================================
# NOTES:
# ==========================================
# 1. NEVER commit .env files with real secrets to version control
# 2. Use strong, unique secrets for JWT_SECRET and other sensitive values
# 3. Generate secrets using: openssl rand -base64 32
# 4. Rotate secrets regularly in production
# 5. Use different secrets for development, staging, and production
# 6. Consider using a secrets manager (AWS Secrets Manager, HashiCorp Vault) for production
# 7. Ensure DATABASE_URL and REDIS_URL use SSL in production
# 8. Set GRAPHQL_PLAYGROUND=false and GRAPHQL_INTROSPECTION=false in production

# ==========================================
# PRODUCTION/DEPLOYMENT CONFIGURATION
# ==========================================

# Redis Configuration
REDIS_URL=rediss://:password@your-redis.upstash.io:6379
# Alternative format: redis://localhost:6379

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW_MS=900000

# CORS Configuration (production)
CORS_ORIGIN=https://your-domain.vercel.app
# Multiple origins: https://your-domain.vercel.app,https://www.your-domain.com

# Security
JWT_SECRET=<generate-with-openssl-rand-base64-32>
SESSION_SECRET=<generate-with-openssl-rand-base64-32>

# Service Configuration
PORT=4000
NODE_ENV=production

# Telemetry
ENABLE_TELEMETRY=true

# ==========================================
# MONITORING & LOGGING
# ==========================================

# Sentry (optional)
# SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
# SENTRY_ENVIRONMENT=production

# Log Level
LOG_LEVEL=info
